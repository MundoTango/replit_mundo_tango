ğŸ›  You Are:

A full-stack Replit developer building a memory-driven platform for Mundo Tango. Youâ€™ve already implemented:
	â€¢	âœ… OAuth via Replit
	â€¢	âœ… Supabase backend with RBAC/ABAC
	â€¢	âœ… Consent-based tagging + memory visibility
	â€¢	âœ… A working memory dashboard component

â¸»

ğŸ¯ Objective:

Create a complete, secure, and consent-aware flow for + Create New Memory, which lets users:
	1.	Tag a moment with emotional + visual metadata
	2.	Add media (photo, video)
	3.	Request consent from co-tagged users
	4.	Save to the Supabase memories table
	5.	Trigger a consent request if others are tagged

â¸»

ğŸ”§ Scope Breakdown

âœ… FRONTEND: MemoryCreationForm.tsx
	â€¢	Inputs:
	â€¢	title (text)
	â€¢	emotion_tags (multi-select chip input)
	â€¢	location (Google Maps autocomplete or manual)
	â€¢	date (calendar picker)
	â€¢	media_file (optional)
	â€¢	co_tags (select users by username/email)
	â€¢	visibility_tier (public, mutual, private)
	â€¢	Consent logic:
	â€¢	Show âš ï¸ if tagging users who havenâ€™t pre-approved
	â€¢	Display: â€œConsent will be requested for [X] before memory is visible to them.â€

âœ… FRONTEND HOOK: Open Modal from Button

In MemoryDashboard.tsx, replace:
<button ...>+ Create New Memory</button>
with:
<button onClick={() => setShowCreateModal(true)} ...>
  + Create New Memory
</button>
<CreateMemoryModal open={showCreateModal} onClose={() => setShowCreateModal(false)} />
âœ… BACKEND: POST /api/memories
	â€¢	Validates:
	â€¢	user_id from session
	â€¢	All co-tagged users exist
	â€¢	Saves memory with consent_status: 'pending' if co_tags exist
	â€¢	Triggers email or in-app consent request (via N8N or Supabase trigger)

â¸»

âœ… DATABASE (Supabase):

Ensure memories table includes:
title TEXT,
emotion_tags TEXT[],
location TEXT,
date DATE,
media_url TEXT,
created_by UUID REFERENCES users(id),
co_tags UUID[],
consent_status TEXT CHECK (consent_status IN ('pending', 'granted', 'denied')),
visibility_tier TEXT CHECK (visibility_tier IN ('public', 'friends', 'private'))
âœ… Add This to replit.md:# Create New Memory Flow

Users can now post memories tagged with:
- Emotions
- Roles
- Places
- Media (optional)
- Visibility Tier
- Consent-aware co-tagging

Co-tagging triggers consent checks. All memory surfacing respects trust level and ABAC/RLS logic.
ğŸ§ª Test Cases
	â€¢	âœ… Create memory with no co-tags â†’ should auto-publish
	â€¢	âœ… Tag 2 users without prior consent â†’ show warning + mark consent_status: 'pending'
	â€¢	âœ… Consent approved (via webhook) â†’ set consent_status: 'granted'